<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>compare_with_leadDBS_version</title>
<meta name="generator" content="MATLAB 23.2">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2024-03-18">
<meta name="DC.source" content="compare_with_leadDBS_version.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#2">Plot leadsAtlas</a>
</li>
<li>
<a href="#3">plot overlap maps</a>
</li>
<li>
<a href="#8">overlap statistics</a>
</li>
</ul>
</div>
<pre class="codeinput">
<span class="comment">% J Eugenio Iglesias provided LeadDBS with a copy of the thalamic atlas</span>
<span class="comment">% probability space in MNI152NLin2009bAsym space. He described it like so,</span>
<span class="comment">% 'I hacked some probabilistic maps for Andy Horn that are in the latest</span>
<span class="comment">% version of LeadDBS.'</span>
<span class="comment">% I ripped those atlas volumes out of LeadDBS (install it and check in</span>
<span class="comment">% 'INSTALL_ROOT/application/LeadDBS_mcr/LeadDBS/packages/leaddbs/templates/space/MNI152NLin2009bAsym/atlases/Probabilistic</span>
<span class="comment">% Thalamus Atlas (Iglesias 2018)') and this script compares those</span>
<span class="comment">% segmentations with my own HCP derived ones.</span>

addpath(<span class="string">'/home/bogdan/.matlab/spm/spm12'</span>);
addpath(genpath(<span class="string">'/home/bogdan/.matlab/canlab/CanlabCore'</span>))
addpath(genpath(<span class="string">'/home/bogdan/.matlab/canlab/Neuroimaging_Pattern_Masks'</span>))

<span class="comment">% path to where I placed the 'Probabilistic Thalamus Atlas (Iglesias 2018)'</span>
<span class="comment">% directory</span>
leaddbsRoot=<span class="string">'/home/bogdan/MyDocuments/canlab/atlases/_resources/LeadsDBS/'</span>;

space_description = <span class="string">'MNI152NLin2009cAsym'</span>;

myAtlas = load_atlas(<span class="string">'iglesias_thal_fmriprep20'</span>);

ref = fmri_data(which(<span class="string">'MNI152NLin2009cAsym_T1_1mm.nii.gz'</span>));

fnames = dir([leaddbsRoot, <span class="string">'Probablistic Thalamus Atlas (Iglesias 2018)/lh/*nii.gz'</span>]);

leadsAtlas = {};
leadsLabel = {};
<span class="keyword">for</span> i = 1:length(fnames)
    leadsAtlas{end+1} = fmri_data([fnames(i).folder, <span class="string">'/'</span>, fnames(i).name]).resample_space(ref);
    leadsLabel{end+1} = [<span class="string">'L_'</span>, strrep(strrep(strrep(strrep(fnames(i).name, <span class="string">'.nii.gz'</span>,<span class="string">''</span>),<span class="string">'-'</span>,<span class="string">'_'</span>),<span class="string">'Sg'</span>,<span class="string">'SG'</span>),<span class="string">'MV(Re)'</span>,<span class="string">'MV_Re'</span>)];
<span class="keyword">end</span>

fnames = dir([leaddbsRoot, <span class="string">'Probablistic Thalamus Atlas (Iglesias 2018)/rh/*nii.gz'</span>]);

<span class="keyword">for</span> i = 1:length(fnames)
    leadsAtlas{end+1} = fmri_data([fnames(i).folder, <span class="string">'/'</span>, fnames(i).name]).resample_space(ref);
    leadsLabel{end+1} = [<span class="string">'R_'</span>, strrep(strrep(strrep(strrep(fnames(i).name, <span class="string">'.nii.gz'</span>,<span class="string">''</span>),<span class="string">'-'</span>,<span class="string">'_'</span>),<span class="string">'Sg'</span>,<span class="string">'SG'</span>),<span class="string">'MV(Re)'</span>,<span class="string">'MV_Re'</span>)];
<span class="keyword">end</span>



leadsAtlas = cat(leadsAtlas{:});

<span class="comment">% renormalize</span>
p_total = sum(leadsAtlas.dat,2);
leadsAtlas.dat(p_total&gt;1,:) = leadsAtlas.dat(p_total&gt;1,:)./p_total(p_total&gt;1);
leadsAtlas = atlas(leadsAtlas,<span class="string">'labels'</span>,leadsLabel);
</pre>
<pre class="codeoutput">Loading atlas: /home/bogdan/.matlab/canlab/Neuroimaging_Pattern_Masks/Atlases_and_parcellations/2018_Iglesias_thalamic_HCP278_reconstruction/iglesias_HCP278_ST76_PG264_MNI152NLin2009cAsym_atlas_object.mat
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
Direct calls to spm_defauts are deprecated.
Please use spm('Defaults',modality) or spm_get_defaults instead.
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 7776284 bytes
Loading image number:     1
Elapsed time is 0.035166 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 8861  Bit rate: 13.11 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1395456 bytes
Loading image number:     1
Elapsed time is 0.007942 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 12669  Bit rate: 13.63 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1323920 bytes
Loading image number:     1
Elapsed time is 0.006402 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 20019  Bit rate: 14.29 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1076160 bytes
Loading image number:     1
Elapsed time is 0.005179 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 22294  Bit rate: 14.44 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1179200 bytes
Loading image number:     1
Elapsed time is 0.008998 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 14370  Bit rate: 13.81 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1259040 bytes
Loading image number:     1
Elapsed time is 0.004805 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 8816  Bit rate: 13.11 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1244880 bytes
Loading image number:     1
Elapsed time is 0.005327 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 6348  Bit rate: 12.63 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 487600 bytes
Loading image number:     1
Elapsed time is 0.002973 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 16073  Bit rate: 13.97 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1264640 bytes
Loading image number:     1
Elapsed time is 0.004676 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 14913  Bit rate: 13.86 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1126320 bytes
Loading image number:     1
Elapsed time is 0.004404 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 22592  Bit rate: 14.46 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1343680 bytes
Loading image number:     1
Elapsed time is 0.004815 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 35781  Bit rate: 15.13 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 594432 bytes
Loading image number:     1
Elapsed time is 0.003287 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 17164  Bit rate: 14.07 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1332256 bytes
Loading image number:     1
Elapsed time is 0.004864 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 6995  Bit rate: 12.77 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 948480 bytes
Loading image number:     1
Elapsed time is 0.004138 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 3965  Bit rate: 11.95 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1302336 bytes
Loading image number:     1
Elapsed time is 0.005059 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 13643  Bit rate: 13.74 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1200640 bytes
Loading image number:     1
Elapsed time is 0.004274 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 9264  Bit rate: 13.18 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1222144 bytes
Loading image number:     1
Elapsed time is 0.004844 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 19913  Bit rate: 14.28 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1263240 bytes
Loading image number:     1
Elapsed time is 0.004707 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 23524  Bit rate: 14.52 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1279200 bytes
Loading image number:     1
Elapsed time is 0.004573 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 19697  Bit rate: 14.27 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1492224 bytes
Loading image number:     1
Elapsed time is 0.005326 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 33284  Bit rate: 15.02 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1577664 bytes
Loading image number:     1
Elapsed time is 0.005504 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 27562  Bit rate: 14.75 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 875520 bytes
Loading image number:     1
Elapsed time is 0.003607 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 12323  Bit rate: 13.59 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1357824 bytes
Loading image number:     1
Elapsed time is 0.005444 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 38903  Bit rate: 15.25 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1447040 bytes
Loading image number:     1
Elapsed time is 0.005546 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 49079  Bit rate: 15.58 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 875520 bytes
Loading image number:     1
Elapsed time is 0.003854 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 11606  Bit rate: 13.50 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1425760 bytes
Loading image number:     1
Elapsed time is 0.004920 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 38189  Bit rate: 15.22 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1479360 bytes
Loading image number:     1
Elapsed time is 0.005006 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 13146  Bit rate: 13.68 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1275948 bytes
Loading image number:     1
Elapsed time is 0.005850 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 21087  Bit rate: 14.36 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 997920 bytes
Loading image number:     1
Elapsed time is 0.003830 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 22114  Bit rate: 14.43 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1436160 bytes
Loading image number:     1
Elapsed time is 0.005030 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 16011  Bit rate: 13.97 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 794376 bytes
Loading image number:     1
Elapsed time is 0.004079 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 10201  Bit rate: 13.32 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1219680 bytes
Loading image number:     1
Elapsed time is 0.004507 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 6780  Bit rate: 12.73 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 406080 bytes
Loading image number:     1
Elapsed time is 0.002731 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 14710  Bit rate: 13.84 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1132300 bytes
Loading image number:     1
Elapsed time is 0.004152 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 15316  Bit rate: 13.90 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1220472 bytes
Loading image number:     1
Elapsed time is 0.005123 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 23206  Bit rate: 14.50 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1445136 bytes
Loading image number:     1
Elapsed time is 0.005356 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 37183  Bit rate: 15.18 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 551200 bytes
Loading image number:     1
Elapsed time is 0.002996 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 15533  Bit rate: 13.92 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1538976 bytes
Loading image number:     1
Elapsed time is 0.005029 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 7962  Bit rate: 12.96 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1096656 bytes
Loading image number:     1
Elapsed time is 0.004027 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 4892  Bit rate: 12.26 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1201200 bytes
Loading image number:     1
Elapsed time is 0.004222 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 13645  Bit rate: 13.74 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1475496 bytes
Loading image number:     1
Elapsed time is 0.005520 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 10051  Bit rate: 13.30 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 785664 bytes
Loading image number:     1
Elapsed time is 0.003799 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 20352  Bit rate: 14.31 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 750288 bytes
Loading image number:     1
Elapsed time is 0.003781 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 24244  Bit rate: 14.57 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 821712 bytes
Loading image number:     1
Elapsed time is 0.003438 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 20371  Bit rate: 14.31 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1041448 bytes
Loading image number:     1
Elapsed time is 0.004152 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 36303  Bit rate: 15.15 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1630728 bytes
Loading image number:     1
Elapsed time is 0.005306 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 30824  Bit rate: 14.91 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1244400 bytes
Loading image number:     1
Elapsed time is 0.004412 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 13587  Bit rate: 13.73 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1401400 bytes
Loading image number:     1
Elapsed time is 0.006062 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 40245  Bit rate: 15.30 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1408960 bytes
Loading image number:     1
Elapsed time is 0.005078 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 50335  Bit rate: 15.62 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 978120 bytes
Loading image number:     1
Elapsed time is 0.004168 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 12325  Bit rate: 13.59 bits
Using default mask: /home/bogdan/.matlab/canlab/CanlabCore/CanlabCore/canlab_canonical_brains/Canonical_brains_surfaces/brainmask_canlab.nii
loading mask. mapping volumes. 
checking that dimensions and voxel sizes of volumes are the same. 
Pre-allocating data array. Needed: 1489296 bytes
Loading image number:     1
Elapsed time is 0.005193 seconds.
Image names entered, but fullpath attribute is empty. Getting path info.
Number of unique values in dataset: 37136  Bit rate: 15.18 bits
</pre>
<h2 id="2">Plot leadsAtlas</h2>
<pre class="codeinput">cmap = scn_standard_colors(num_regions(leadsAtlas)/2);
cmap = cell2mat(cat(2,cmap'));
cmap = [cmap; cmap];

o2 = canlab_results_fmridisplay([], <span class="string">'full hcp'</span>, <span class="keyword">...</span>
    <span class="string">'overlay'</span>, which(sprintf(<span class="string">'%s_T1_1mm.nii.gz'</span>,space_description)));
brighten(.6)

o2 = montage(atlas2region(leadsAtlas), o2, <span class="string">'wh_montages'</span>, 1:2, <span class="string">'indexmap'</span>, cmap);
</pre>
<pre class="codeoutput">Setting up fmridisplay objects
Compressed NIfTI files are not supported.
    48

Warning: Indexmap requires 'interp','nearest' but these were not specified.
Adding them automatically 
sagittal montage: 6742 voxels displayed, 34641 not displayed on these slices
Warning: Indexmap requires 'interp','nearest' but these were not specified.
Adding them automatically 
coronal montage: 5199 voxels displayed, 36184 not displayed on these slices
</pre>
<img vspace="5" hspace="5" src="compare_with_leadDBS_version_01.png" alt=""> <h2 id="3">plot overlap maps</h2>
<pre class="codeinput">thisAtlas = myAtlas.select_atlas_subset(<span class="string">'L_'</span>).threshold(0.2);
thisAtlas = thisAtlas.select_atlas_subset(find(~contains(thisAtlas.labels,{<span class="string">'R_L'</span>,<span class="string">'PuMm'</span>,<span class="string">'PuMl'</span>})));
thisAtlas.probability_maps = [];
thisLeadsAtlas = leadsAtlas.select_atlas_subset(thisAtlas.labels,<span class="string">'exact'</span>).threshold(0.2);
thisLeadsAtlas.probability_maps = [];
<span class="keyword">for</span> orientation = {<span class="string">'saggital'</span>,<span class="string">'coronal'</span>,<span class="string">'axial'</span>}
</pre>
<pre class="codeinput">    o2 = thisAtlas.montage(<span class="string">'transvalue'</span>,0.5,<span class="string">'regioncenters'</span>,orientation{1});
    <span class="keyword">for</span> i = 1:num_regions(thisAtlas)
        <span class="keyword">try</span>
            label = thisAtlas.labels{i};
            <span class="keyword">if</span> contains(label,<span class="string">'VPM_VPL'</span>)
                label = label(1:end-4);
            <span class="keyword">end</span>
            leads_roi = thisLeadsAtlas.select_atlas_subset(label,<span class="string">'exact'</span>);

            <span class="keyword">if</span> num_regions(leads_roi) == 1
                o3 = o2;
                o3.activation_maps = o2.activation_maps(i);
                o3.montage = o2.montage(i);
                leads_roi.montage(o3,<span class="string">'existing_figure'</span>,<span class="string">'existing_axes'</span>, o2.montage{i}.axis_handles,<span class="string">'outline'</span>,<span class="string">'color'</span>,[0,0,0]);
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>

    set(gcf,<span class="string">'Tag'</span>,orientation{1})
</pre>
<pre class="codeoutput">Compressed NIfTI files are not supported.
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:L_AV. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  88 voxels displayed, 196 not displayed on these slices
Warning: Unknown input string option:L_CeM. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  44 voxels displayed, 139 not displayed on these slices
Warning: Unknown input string option:L_CL. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  11 voxels displayed,  43 not displayed on these slices
Warning: Unknown input string option:L_CM. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  62 voxels displayed, 367 not displayed on these slices
Warning: Unknown input string option:L_LD. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  12 voxels displayed,  64 not displayed on these slices
Warning: Unknown input string option:L_LGN. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  81 voxels displayed, 495 not displayed on these slices
Warning: Unknown input string option:L_LP. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  32 voxels displayed, 154 not displayed on these slices
Warning: Unknown input string option:L_L_SG. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  16 voxels displayed,  72 not displayed on these slices
Warning: Unknown input string option:L_MDl. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  68 voxels displayed, 290 not displayed on these slices
Warning: Unknown input string option:L_MDm. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage: 195 voxels displayed, 774 not displayed on these slices
Warning: Unknown input string option:L_MGN. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  39 voxels displayed, 249 not displayed on these slices
Warning: Unknown input string option:L_MV_Re. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  22 voxels displayed,  23 not displayed on these slices
Warning: Unknown input string option:L_Pf. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  23 voxels displayed,  57 not displayed on these slices
Warning: Unknown input string option:L_PuA. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  42 voxels displayed, 261 not displayed on these slices
Warning: Unknown input string option:L_PuI. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  51 voxels displayed, 533 not displayed on these slices
Warning: Unknown input string option:L_PuL. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  50 voxels displayed, 349 not displayed on these slices
Warning: Unknown input string option:L_VA. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage: 117 voxels displayed, 717 not displayed on these slices
Warning: Unknown input string option:L_VAmc. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:   4 voxels displayed,  12 not displayed on these slices
Warning: Unknown input string option:L_VLa. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  99 voxels displayed, 862 not displayed on these slices
Warning: Unknown input string option:L_VLp. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage: 163 voxels displayed, 1216 not displayed on these slices
Warning: Unknown input string option:L_VPL_VPM. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:R_VPL_VPM. Assuming it might be an atlas
label. Place atlas labels in a cell array 
</pre>
<img vspace="5" hspace="5" src="compare_with_leadDBS_version_02.png" alt=""> <pre class="codeoutput">Compressed NIfTI files are not supported.
Warning: Unknown input string option:L_AV. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  48 voxels displayed, 236 not displayed on these slices
Warning: Unknown input string option:L_CeM. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  14 voxels displayed, 169 not displayed on these slices
Warning: Unknown input string option:L_CL. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:   5 voxels displayed,  49 not displayed on these slices
Warning: Unknown input string option:L_CM. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  56 voxels displayed, 373 not displayed on these slices
Warning: Unknown input string option:L_LD. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:   9 voxels displayed,  67 not displayed on these slices
Warning: Unknown input string option:L_LGN. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  75 voxels displayed, 501 not displayed on these slices
Warning: Unknown input string option:L_LP. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  18 voxels displayed, 168 not displayed on these slices
Warning: Unknown input string option:L_L_SG. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  15 voxels displayed,  73 not displayed on these slices
Warning: Unknown input string option:L_MDl. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  41 voxels displayed, 317 not displayed on these slices
Warning: Unknown input string option:L_MDm. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  76 voxels displayed, 893 not displayed on these slices
Warning: Unknown input string option:L_MGN. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  62 voxels displayed, 226 not displayed on these slices
Warning: Unknown input string option:L_MV_Re. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:   7 voxels displayed,  38 not displayed on these slices
Warning: Unknown input string option:L_Pf. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:   6 voxels displayed,  74 not displayed on these slices
Warning: Unknown input string option:L_PuA. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  38 voxels displayed, 265 not displayed on these slices
Warning: Unknown input string option:L_PuI. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  95 voxels displayed, 489 not displayed on these slices
Warning: Unknown input string option:L_PuL. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  57 voxels displayed, 342 not displayed on these slices
Warning: Unknown input string option:L_VA. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage: 128 voxels displayed, 706 not displayed on these slices
Warning: Unknown input string option:L_VAmc. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:   0 voxels displayed,  16 not displayed on these slices
Warning: Unknown input string option:L_VLa. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage: 124 voxels displayed, 837 not displayed on these slices
Warning: Unknown input string option:L_VLp. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage: 148 voxels displayed, 1231 not displayed on these slices
Warning: Unknown input string option:L_VPL_VPM. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:R_VPL_VPM. Assuming it might be an atlas
label. Place atlas labels in a cell array 
</pre>
<img vspace="5" hspace="5" src="compare_with_leadDBS_version_03.png" alt=""> <pre class="codeoutput">Compressed NIfTI files are not supported.
Warning: Unknown input string option:L_AV. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  25 voxels displayed, 259 not displayed on these slices
Warning: Unknown input string option:L_CeM. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  30 voxels displayed, 153 not displayed on these slices
Warning: Unknown input string option:L_CL. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:   5 voxels displayed,  49 not displayed on these slices
Warning: Unknown input string option:L_CM. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  45 voxels displayed, 384 not displayed on these slices
Warning: Unknown input string option:L_LD. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  30 voxels displayed,  46 not displayed on these slices
Warning: Unknown input string option:L_LGN. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  75 voxels displayed, 501 not displayed on these slices
Warning: Unknown input string option:L_LP. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  46 voxels displayed, 140 not displayed on these slices
Warning: Unknown input string option:L_L_SG. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  17 voxels displayed,  71 not displayed on these slices
Warning: Unknown input string option:L_MDl. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  27 voxels displayed, 331 not displayed on these slices
Warning: Unknown input string option:L_MDm. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  82 voxels displayed, 887 not displayed on these slices
Warning: Unknown input string option:L_MGN. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  42 voxels displayed, 246 not displayed on these slices
Warning: Unknown input string option:L_MV_Re. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  15 voxels displayed,  30 not displayed on these slices
Warning: Unknown input string option:L_Pf. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:   3 voxels displayed,  77 not displayed on these slices
Warning: Unknown input string option:L_PuA. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  30 voxels displayed, 273 not displayed on these slices
Warning: Unknown input string option:L_PuI. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  75 voxels displayed, 509 not displayed on these slices
Warning: Unknown input string option:L_PuL. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  31 voxels displayed, 368 not displayed on these slices
Warning: Unknown input string option:L_VA. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  57 voxels displayed, 777 not displayed on these slices
Warning: Unknown input string option:L_VAmc. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:   4 voxels displayed,  12 not displayed on these slices
Warning: Unknown input string option:L_VLa. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  46 voxels displayed, 915 not displayed on these slices
Warning: Unknown input string option:L_VLp. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  71 voxels displayed, 1308 not displayed on these slices
Warning: Unknown input string option:L_VPL_VPM. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:R_VPL_VPM. Assuming it might be an atlas
label. Place atlas labels in a cell array 
</pre>
<img vspace="5" hspace="5" src="compare_with_leadDBS_version_04.png" alt=""> <pre class="codeinput">
<span class="keyword">end</span>

thisAtlas = myAtlas.select_atlas_subset(<span class="string">'R_'</span>).threshold(0.2);
thisAtlas = thisAtlas.select_atlas_subset(find(~contains(thisAtlas.labels,{<span class="string">'PuMm'</span>,<span class="string">'PuMl'</span>})));
thisAtlas.probability_maps = [];
thisLeadsAtlas = leadsAtlas.select_atlas_subset(thisAtlas.labels,<span class="string">'exact'</span>).threshold(0.2);
thisLeadsAtlas.probability_maps = [];
<span class="keyword">for</span> orientation = {<span class="string">'saggital'</span>,<span class="string">'coronal'</span>,<span class="string">'axial'</span>}
</pre>
<pre class="codeinput">    o2 = thisAtlas.montage(<span class="string">'transvalue'</span>,0.5,<span class="string">'regioncenters'</span>,orientation{1});
    <span class="keyword">for</span> i = 1:num_regions(thisAtlas)
        <span class="keyword">try</span>
            label = thisAtlas.labels{i};
            <span class="keyword">if</span> contains(label,<span class="string">'VPM_VPL'</span>)
                label = label(1:end-4);
            <span class="keyword">end</span>
            leads_roi = thisLeadsAtlas.select_atlas_subset(label,<span class="string">'exact'</span>);

            <span class="keyword">if</span> num_regions(leads_roi) == 1
                o3 = o2;
                o3.activation_maps = o2.activation_maps(i);
                o3.montage = o2.montage(i);
                leads_roi.montage(o3,<span class="string">'existing_figure'</span>,<span class="string">'existing_axes'</span>, o2.montage{i}.axis_handles,<span class="string">'outline'</span>,<span class="string">'color'</span>,[0,0,0]);
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
    set(gcf,<span class="string">'Tag'</span>,orientation{1})
</pre>
<pre class="codeoutput">Compressed NIfTI files are not supported.
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:saggital 
Warning: Unknown input string option:R_AV. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  89 voxels displayed, 245 not displayed on these slices
Warning: Unknown input string option:R_CeM. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  40 voxels displayed, 155 not displayed on these slices
Warning: Unknown input string option:R_CL. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:   7 voxels displayed,  48 not displayed on these slices
Warning: Unknown input string option:R_CM. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  88 voxels displayed, 363 not displayed on these slices
Warning: Unknown input string option:R_LD. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  26 voxels displayed,  57 not displayed on these slices
Warning: Unknown input string option:R_LGN. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  77 voxels displayed, 434 not displayed on these slices
Warning: Unknown input string option:R_LP. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  39 voxels displayed, 169 not displayed on these slices
Warning: Unknown input string option:R_L_SG. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  19 voxels displayed,  64 not displayed on these slices
Warning: Unknown input string option:R_MDl. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  85 voxels displayed, 323 not displayed on these slices
Warning: Unknown input string option:R_MDm. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage: 190 voxels displayed, 777 not displayed on these slices
Warning: Unknown input string option:R_MGN. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  48 voxels displayed, 260 not displayed on these slices
Warning: Unknown input string option:R_MV_Re. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:   3 voxels displayed,  49 not displayed on these slices
Warning: Unknown input string option:R_Pf. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  31 voxels displayed,  74 not displayed on these slices
Warning: Unknown input string option:R_PuA. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  39 voxels displayed, 275 not displayed on these slices
Warning: Unknown input string option:R_PuI. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  48 voxels displayed, 523 not displayed on these slices
Warning: Unknown input string option:R_PuL. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:  53 voxels displayed, 328 not displayed on these slices
Warning: Unknown input string option:R_VA. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage: 118 voxels displayed, 760 not displayed on these slices
Warning: Unknown input string option:R_VAmc. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage:   7 voxels displayed,  13 not displayed on these slices
Warning: Unknown input string option:R_VLa. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage: 110 voxels displayed, 927 not displayed on these slices
Warning: Unknown input string option:R_VLp. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
sagittal montage: 166 voxels displayed, 1219 not displayed on these slices
Warning: Unknown input string option:R_VPL_VPM. Assuming it might be an atlas
label. Place atlas labels in a cell array 
</pre>
<img vspace="5" hspace="5" src="compare_with_leadDBS_version_05.png" alt=""> <pre class="codeoutput">Compressed NIfTI files are not supported.
Warning: Unknown input string option:R_AV. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  50 voxels displayed, 284 not displayed on these slices
Warning: Unknown input string option:R_CeM. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  16 voxels displayed, 179 not displayed on these slices
Warning: Unknown input string option:R_CL. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:   6 voxels displayed,  49 not displayed on these slices
Warning: Unknown input string option:R_CM. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  63 voxels displayed, 388 not displayed on these slices
Warning: Unknown input string option:R_LD. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:   9 voxels displayed,  74 not displayed on these slices
Warning: Unknown input string option:R_LGN. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  65 voxels displayed, 446 not displayed on these slices
Warning: Unknown input string option:R_LP. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  22 voxels displayed, 186 not displayed on these slices
Warning: Unknown input string option:R_L_SG. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  18 voxels displayed,  65 not displayed on these slices
Warning: Unknown input string option:R_MDl. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  48 voxels displayed, 360 not displayed on these slices
Warning: Unknown input string option:R_MDm. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  78 voxels displayed, 889 not displayed on these slices
Warning: Unknown input string option:R_MGN. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  57 voxels displayed, 251 not displayed on these slices
Warning: Unknown input string option:R_MV_Re. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:   7 voxels displayed,  45 not displayed on these slices
Warning: Unknown input string option:R_Pf. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:   7 voxels displayed,  98 not displayed on these slices
Warning: Unknown input string option:R_PuA. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  45 voxels displayed, 269 not displayed on these slices
Warning: Unknown input string option:R_PuI. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  72 voxels displayed, 499 not displayed on these slices
Warning: Unknown input string option:R_PuL. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:  49 voxels displayed, 332 not displayed on these slices
Warning: Unknown input string option:R_VA. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage: 124 voxels displayed, 754 not displayed on these slices
Warning: Unknown input string option:R_VAmc. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage:   6 voxels displayed,  14 not displayed on these slices
Warning: Unknown input string option:R_VLa. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage: 126 voxels displayed, 911 not displayed on these slices
Warning: Unknown input string option:R_VLp. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
coronal montage: 151 voxels displayed, 1234 not displayed on these slices
Warning: Unknown input string option:R_VPL_VPM. Assuming it might be an atlas
label. Place atlas labels in a cell array 
</pre>
<img vspace="5" hspace="5" src="compare_with_leadDBS_version_06.png" alt=""> <pre class="codeoutput">Compressed NIfTI files are not supported.
Warning: Unknown input string option:R_AV. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  29 voxels displayed, 305 not displayed on these slices
Warning: Unknown input string option:R_CeM. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  31 voxels displayed, 164 not displayed on these slices
Warning: Unknown input string option:R_CL. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:   7 voxels displayed,  48 not displayed on these slices
Warning: Unknown input string option:R_CM. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  47 voxels displayed, 404 not displayed on these slices
Warning: Unknown input string option:R_LD. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  29 voxels displayed,  54 not displayed on these slices
Warning: Unknown input string option:R_LGN. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  68 voxels displayed, 443 not displayed on these slices
Warning: Unknown input string option:R_LP. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  51 voxels displayed, 157 not displayed on these slices
Warning: Unknown input string option:R_L_SG. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  18 voxels displayed,  65 not displayed on these slices
Warning: Unknown input string option:R_MDl. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  39 voxels displayed, 369 not displayed on these slices
Warning: Unknown input string option:R_MDm. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  81 voxels displayed, 886 not displayed on these slices
Warning: Unknown input string option:R_MGN. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  41 voxels displayed, 267 not displayed on these slices
Warning: Unknown input string option:R_MV_Re. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  20 voxels displayed,  32 not displayed on these slices
Warning: Unknown input string option:R_Pf. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:   9 voxels displayed,  96 not displayed on these slices
Warning: Unknown input string option:R_PuA. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  32 voxels displayed, 282 not displayed on these slices
Warning: Unknown input string option:R_PuI. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  78 voxels displayed, 493 not displayed on these slices
Warning: Unknown input string option:R_PuL. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  30 voxels displayed, 351 not displayed on these slices
Warning: Unknown input string option:R_VA. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  62 voxels displayed, 816 not displayed on these slices
Warning: Unknown input string option:R_VAmc. Assuming it might be an atlas
label. Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:   4 voxels displayed,  16 not displayed on these slices
Warning: Unknown input string option:R_VLa. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  53 voxels displayed, 984 not displayed on these slices
Warning: Unknown input string option:R_VLp. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Warning: Unknown input string option:existing_figure 
Warning: Unknown input string option:existing_axes 
axial montage:  70 voxels displayed, 1315 not displayed on these slices
Warning: Unknown input string option:R_VPL_VPM. Assuming it might be an atlas
label. Place atlas labels in a cell array 
</pre>
<img vspace="5" hspace="5" src="compare_with_leadDBS_version_07.png" alt=""> <pre class="codeinput">
<span class="keyword">end</span>
</pre>
<pre class="codeoutput">Warning: Unknown input string option:L_. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Keeping probability_map values above 0.20
Keeping probability_map values above 0.20
Warning: Unknown input string option:R_. Assuming it might be an atlas label.
Place atlas labels in a cell array 
Keeping probability_map values above 0.20
Keeping probability_map values above 0.20
</pre>
<h2 id="8">overlap statistics</h2>
<pre class="codeinput">[d,r] = deal(zeros(num_regions(myAtlas),1));
<span class="keyword">for</span> i = 1:length(myAtlas.labels)
    <span class="keyword">try</span>
    leads_roi = leadsAtlas.select_atlas_subset(myAtlas.labels(i),<span class="string">'exact'</span>);
    my_roi = myAtlas.select_atlas_subset(myAtlas.labels(i),<span class="string">'exact'</span>);
    <span class="keyword">catch</span>
        <span class="keyword">continue</span>
    <span class="keyword">end</span>

    <span class="keyword">if</span> num_regions(leads_roi) == 1
        joint_vx = logical(leads_roi.dat | my_roi.dat);
        r(i) = corr(leads_roi.probability_maps(joint_vx), my_roi.probability_maps(joint_vx));
    <span class="keyword">elseif</span> num_regions(leads_roi) &gt; 1
        error(<span class="string">'Too many regions'</span>)
    <span class="keyword">end</span>
<span class="keyword">end</span>


thresh = 0.2;
leadsAtlas = leadsAtlas.threshold(thresh);
leadsAtlas.probability_maps = [];
myAtlas = myAtlas.threshold(thresh);
myAtlas.probability_maps = [];
<span class="keyword">for</span> i = 1:length(myAtlas.labels)
    <span class="keyword">try</span>
    leads_roi = leadsAtlas.select_atlas_subset(myAtlas.labels(i),<span class="string">'exact'</span>);
    my_roi = myAtlas.select_atlas_subset(myAtlas.labels(i),<span class="string">'exact'</span>);
    <span class="keyword">catch</span>
        <span class="keyword">continue</span>
    <span class="keyword">end</span>

    <span class="keyword">if</span> num_regions(leads_roi) == 1
        coef = 2*sum(leads_roi.dat.*my_roi.dat) / (sum(leads_roi.dat) + sum(my_roi.dat));
        d(i) = coef;
    <span class="keyword">elseif</span> num_regions(leads_roi) &gt; 1
        error(<span class="string">'Too many regions'</span>)
    <span class="keyword">end</span>
<span class="keyword">end</span>


figure;
hist(d(d~=0))
title(<span class="string">'Dice coefficient for LeadDBS Iglesias atlas vs. HCP278 Atlas'</span>)
xlabel(<span class="string">'Dice Coef.'</span>)

figure;
hist(r(r~=0))
title({<span class="string">'Correnation coefficient for LeadDBS Iglesias atlas'</span>,<span class="string">'vs. HCP278 Atlas'' probabilities'</span>});
xlabel(<span class="string">'Pearson r'</span>)
</pre>
<pre class="codeoutput">Keeping probability_map values above 0.20
Keeping probability_map values above 0.20
</pre>
<img vspace="5" hspace="5" src="compare_with_leadDBS_version_08.png" alt=""> <img vspace="5" hspace="5" src="compare_with_leadDBS_version_09.png" alt=""> <p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2023b</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
% J Eugenio Iglesias provided LeadDBS with a copy of the thalamic atlas
% probability space in MNI152NLin2009bAsym space. He described it like so,
% 'I hacked some probabilistic maps for Andy Horn that are in the latest
% version of LeadDBS.'
% I ripped those atlas volumes out of LeadDBS (install it and check in 
% 'INSTALL_ROOT/application/LeadDBS_mcr/LeadDBS/packages/leaddbs/templates/space/MNI152NLin2009bAsym/atlases/Probabilistic
% Thalamus Atlas (Iglesias 2018)') and this script compares those
% segmentations with my own HCP derived ones.

addpath('/home/bogdan/.matlab/spm/spm12');
addpath(genpath('/home/bogdan/.matlab/canlab/CanlabCore'))
addpath(genpath('/home/bogdan/.matlab/canlab/Neuroimaging_Pattern_Masks'))

% path to where I placed the 'Probabilistic Thalamus Atlas (Iglesias 2018)'
% directory
leaddbsRoot='/home/bogdan/MyDocuments/canlab/atlases/_resources/LeadsDBS/';

space_description = 'MNI152NLin2009cAsym';

myAtlas = load_atlas('iglesias_thal_fmriprep20');

ref = fmri_data(which('MNI152NLin2009cAsym_T1_1mm.nii.gz'));

fnames = dir([leaddbsRoot, 'Probablistic Thalamus Atlas (Iglesias 2018)/lh/*nii.gz']);

leadsAtlas = {};
leadsLabel = {};
for i = 1:length(fnames)
    leadsAtlas{end+1} = fmri_data([fnames(i).folder, '/', fnames(i).name]).resample_space(ref);
    leadsLabel{end+1} = ['L_', strrep(strrep(strrep(strrep(fnames(i).name, '.nii.gz',''),'-','_'),'Sg','SG'),'MV(Re)','MV_Re')];
end

fnames = dir([leaddbsRoot, 'Probablistic Thalamus Atlas (Iglesias 2018)/rh/*nii.gz']);

for i = 1:length(fnames)
    leadsAtlas{end+1} = fmri_data([fnames(i).folder, '/', fnames(i).name]).resample_space(ref);
    leadsLabel{end+1} = ['R_', strrep(strrep(strrep(strrep(fnames(i).name, '.nii.gz',''),'-','_'),'Sg','SG'),'MV(Re)','MV_Re')];
end



leadsAtlas = cat(leadsAtlas{:});

% renormalize
p_total = sum(leadsAtlas.dat,2);
leadsAtlas.dat(p_total>1,:) = leadsAtlas.dat(p_total>1,:)./p_total(p_total>1);
leadsAtlas = atlas(leadsAtlas,'labels',leadsLabel);

%% Plot leadsAtlas
cmap = scn_standard_colors(num_regions(leadsAtlas)/2);
cmap = cell2mat(cat(2,cmap'));
cmap = [cmap; cmap];
   
o2 = canlab_results_fmridisplay([], 'full hcp', ...
    'overlay', which(sprintf('%s_T1_1mm.nii.gz',space_description)));
brighten(.6)
    
o2 = montage(atlas2region(leadsAtlas), o2, 'wh_montages', 1:2, 'indexmap', cmap);

%% plot overlap maps

thisAtlas = myAtlas.select_atlas_subset('L_').threshold(0.2);
thisAtlas = thisAtlas.select_atlas_subset(find(~contains(thisAtlas.labels,{'R_L','PuMm','PuMl'})));
thisAtlas.probability_maps = [];
thisLeadsAtlas = leadsAtlas.select_atlas_subset(thisAtlas.labels,'exact').threshold(0.2);
thisLeadsAtlas.probability_maps = [];
for orientation = {'saggital','coronal','axial'}
    %%
    o2 = thisAtlas.montage('transvalue',0.5,'regioncenters',orientation{1});
    for i = 1:num_regions(thisAtlas)
        try
            label = thisAtlas.labels{i};
            if contains(label,'VPM_VPL')
                label = label(1:end-4);
            end
            leads_roi = thisLeadsAtlas.select_atlas_subset(label,'exact');
        
            if num_regions(leads_roi) == 1
                o3 = o2;
                o3.activation_maps = o2.activation_maps(i);
                o3.montage = o2.montage(i);
                leads_roi.montage(o3,'existing_figure','existing_axes', o2.montage{i}.axis_handles,'outline','color',[0,0,0]);
            end
        end
    end
    
    set(gcf,'Tag',orientation{1})
end

thisAtlas = myAtlas.select_atlas_subset('R_').threshold(0.2);
thisAtlas = thisAtlas.select_atlas_subset(find(~contains(thisAtlas.labels,{'PuMm','PuMl'})));
thisAtlas.probability_maps = [];
thisLeadsAtlas = leadsAtlas.select_atlas_subset(thisAtlas.labels,'exact').threshold(0.2);
thisLeadsAtlas.probability_maps = [];
for orientation = {'saggital','coronal','axial'}
    %%
    o2 = thisAtlas.montage('transvalue',0.5,'regioncenters',orientation{1});
    for i = 1:num_regions(thisAtlas)
        try
            label = thisAtlas.labels{i};
            if contains(label,'VPM_VPL')
                label = label(1:end-4);
            end
            leads_roi = thisLeadsAtlas.select_atlas_subset(label,'exact');
        
            if num_regions(leads_roi) == 1
                o3 = o2;
                o3.activation_maps = o2.activation_maps(i);
                o3.montage = o2.montage(i);
                leads_roi.montage(o3,'existing_figure','existing_axes', o2.montage{i}.axis_handles,'outline','color',[0,0,0]);
            end
        end
    end
    set(gcf,'Tag',orientation{1})
end


%% overlap statistics
[d,r] = deal(zeros(num_regions(myAtlas),1));
for i = 1:length(myAtlas.labels)
    try
    leads_roi = leadsAtlas.select_atlas_subset(myAtlas.labels(i),'exact');
    my_roi = myAtlas.select_atlas_subset(myAtlas.labels(i),'exact');
    catch
        continue
    end

    if num_regions(leads_roi) == 1
        joint_vx = logical(leads_roi.dat | my_roi.dat);
        r(i) = corr(leads_roi.probability_maps(joint_vx), my_roi.probability_maps(joint_vx)); 
    elseif num_regions(leads_roi) > 1
        error('Too many regions')
    end
end


thresh = 0.2;
leadsAtlas = leadsAtlas.threshold(thresh);
leadsAtlas.probability_maps = [];
myAtlas = myAtlas.threshold(thresh);
myAtlas.probability_maps = [];
for i = 1:length(myAtlas.labels)
    try
    leads_roi = leadsAtlas.select_atlas_subset(myAtlas.labels(i),'exact');
    my_roi = myAtlas.select_atlas_subset(myAtlas.labels(i),'exact');
    catch
        continue
    end

    if num_regions(leads_roi) == 1
        coef = 2*sum(leads_roi.dat.*my_roi.dat) / (sum(leads_roi.dat) + sum(my_roi.dat));
        d(i) = coef;
    elseif num_regions(leads_roi) > 1
        error('Too many regions')
    end
end


figure;
hist(d(d~=0))
title('Dice coefficient for LeadDBS Iglesias atlas vs. HCP278 Atlas')
xlabel('Dice Coef.')

figure;
hist(r(r~=0))
title({'Correnation coefficient for LeadDBS Iglesias atlas','vs. HCP278 Atlas'' probabilities'});
xlabel('Pearson r')
##### SOURCE END #####
-->
</body>
</html>
